[Unit]
Description=Keycloak Server
After=network-online.target
Wants=network-online.target
AssertFileIsExecutable=/opt/keycloak/bin/kc.sh

[Service]
User=keycloak
Group=keycloak
WorkingDirectory=/home/keycloak
#ExecStart=/opt/keycloak/bin/kc.sh start --https-port=8888 --hostname-backchannel-dynamic=true --https-management-certificate-file=/opt/keycloak/certs/kc.crt.pem --https-management-certificate-key-file=/opt/keycloak/certs/kc.key.pem --hostname=http://keycloak.devops.lab:8080 --hostname-admin=http://keycloak.devops.lab:8080

Restart=always
ExecStart=/opt/keycloak/bin/kc.sh start --https-key-store-file=/etc/pki/ca-trust/source/anchors/server.keystore --https-port=8888 --http-enabled=false --hostname-backchannel-dynamic=true --https-management-certificate-file=/etc/pki/ca-trust/source/anchors/keycloak.crt --https-management-certificate-key-file=/etc/pki/ca-trust/source/anchors/keycloak.key --hostname=https://keycloak.devops.lab:8888 --hostname-admin=https://keycloak.devops.lab:8888

EnvironmentFile=-/etc/default/keycloak
[Install]
WantedBy=multi-user.target

#openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout kc.key.pem -out kc.crt.pem